# MERKI（メルキ） - 要件定義・非機能要件定義書

## 1. 概要
MERKIは、日々の事業運営を支える 制度期限の通知サービスです。
ユーザー情報（会社種別、決算月、設立年月日など）に基づき、必要な税務・労務手続きの期限を自動計算し、リマインドを行います。

## 2. 機能要件 (Functional Requirements)

### 2.1 認証機能
- **新規登録**: メールアドレス・パスワードによるアカウント作成。
- **ログイン**: 登録済みメールアドレス・パスワードによる認証。
- **ログアウト**: セッションの破棄。
- **30日間無料トライアル**: 新規登録時に自動的にトライアル期間（30日）を付与。

### 2.2 プロフィール設定
- **基本情報設定**:
    - 会社種別（法人/個人事業主）
    - 業種（IT/EC/飲食/その他）
    - 従業員数
    - 決算月（1〜12月）
    - **設立年月日**（新規追加）: 消費税免税判定などに使用。
- **データ保存**: 入力情報をデータベース（Firestore）に永続化。

### 2.3 ダッシュボード
- **期限通知 (Upcoming Deadlines)**:
    - 直近（期限が近い順）の届出を表示。
    - 30日前、7日前、当日などのステータス表示。
- **該当制度一覧**:
    - ユーザー情報に基づき、対象となるすべての制度を一覧表示。
- **統計情報**:
    - 該当制度数、直近の期限数、トライアル残日数の表示。
- **サブスクリプション状態**:
    - 現在のプラン（トライアル中/有料/キャンセル済み）の表示。

### 2.4 自動判定ロジック (Logic)
- **制度フィルタリング**:
    - 会社種別、業種、従業員数による不要な制度の除外（例: 従業員50名未満はストレスチェック除外）。
- **期限計算**:
    - 相対日（決算月+2ヶ月など）、固定日（毎月10日など）、毎年固定月（毎年6月など）の計算。
- **消費税免税判定**:
    - 設立年月日から24ヶ月（2年）以内の場合、消費税申告・中間申告を自動的に除外（免税期間と推定）。

    - 設立年月日から24ヶ月（2年）以内の場合、消費税申告・中間申告を自動的に除外（免税期間と推定）。

### 2.5 サブスクリプションプラン (Subscription Plans)
- **Liteプラン (¥980/月)**:
    - 機能: 全制度の期限通知、ダッシュボード閲覧
    - 通知頻度: **前日のみ**
    - ユーザー数: 1名
    - 特典: 30日間無料トライアル
- **Standardプラン (¥1,980/月)**:
    - 機能: Liteの全機能 + 複数ユーザー管理
    - 通知頻度: **7日前 + 前日**
    - ユーザー数: 最大3名
    - 特典: 30日間無料トライアル
- **Proプラン (¥4,980/月)**:
    - 機能: Standardの全機能 + 通知内容編集 + 制度ごとON/OFF + 月初まとめメール
    - 通知頻度: **30日前 + 7日前 + 前日**
    - ユーザー数: 最大10名
    - 特典: 30日間無料トライアル

---

## 3. 非機能要件 (Non-Functional Requirements)

### 3.1 ユーザビリティ (Usability)
- **UI/UX**:
    - **プレミアムデザイン**: グラデーション、ガラスモーフィズム（Glassmorphism）、マイクロインタラクションを用いた高品質なUI。
    - **レスポンシブ対応**: PC、タブレット、スマートフォン（ハンバーガーメニュー含む）での最適化表示。
- **分かりやすさ**:
    - 専門用語を避け、アイコンやバッジを用いた直感的なステータス表示。
    - アクションに対するフィードバック（保存成功メッセージなど）の明示。

### 3.2 パフォーマンス (Performance)
- **読み込み速度**:
    - 静的リソース（HTML/CSS/JS）の最適化。
    - FirebaseSDKのモジュール読み込みによる軽量化。
- **レンダリング**:
    - スムーズなアニメーション（フェードイン、ホバーエフェクト）。

### 3.3 セキュリティ (Security)
- **認証**: Firebase Authenticationを利用した堅牢な認証システム。
- **通信**: HTTPSによる暗号化通信（Netlify/Firebase標準）。
- **データ保護**: Firebase Security Rulesによるアクセス制御（本人のデータのみ読み書き可能）。

### 3.4 運用・保守・拡張性 (Maintainability & Scalability)
- **アーキテクチャ**:
    - フロントエンド主体のServerlessアーキテクチャ（メンテナンスコストの低減）。
- **デプロイ**:
    - Netlifyによる自動ビルド・配信。
- **拡張性**:
    - ロジック（`compliance-logic.js`）のモジュール化により、将来的な制度追加や判定ルールの厳密化（資本金判定の追加など）に対応可能。
- **スケーラビリティに関する制約（Future Scalability）**:
    - **無料プラン（Netlify Starter）の制限**:
        - Netlify Functionsのタイムアウト制限（10秒）により、ユーザー数が1,000人〜数千人を超えると、一斉メール送信処理が完了しないリスクがある。
    - **将来的な対策**:
        - ユーザー規模拡大時は、Netlifyのプランアップグレード（Background Functions利用: タイムアウト15分）またはバッチ処理の分割実行（アーキテクチャ変更）を検討する。

---

## 4. 技術スタック (Technology Stack)
- **Frontend**: HTML5, CSS3, JavaScript (Vanilla ES6 modules)
- **Hosting**: Netlify
- **Backend / Database**: Google Firebase (Authentication, Firestore)
- **Version Control**: Git / GitHub
